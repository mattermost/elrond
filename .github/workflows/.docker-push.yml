---
name: docker-push
on:
  workflow_call:
    inputs:
      is_pr:
        required: true
        type: boolean

env:
  DOCKER_USERNAME: "${{ secrets.DOCKERHUB_USERNAME }}"
  DOCKER_PASSWORD: "${{ secrets.DOCKERHUB_TOKEN }}"

jobs:
  docker-push:
    runs-on: ubuntu-latest
    steps:
    - name: ci/checkout-repo
      uses: actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8 # v5.0.0
    - name: ci/prepare-docker-environment
      uses: ./.github/actions/docker-prepare
    - name: ci/push-image-pr
      run: "make push-image-pr"
      if: "${{ inputs.is_pr }}"
    - name: ci/push-image
      run: "make push-image"
      if: "${{ !inputs.is_pr }}"
